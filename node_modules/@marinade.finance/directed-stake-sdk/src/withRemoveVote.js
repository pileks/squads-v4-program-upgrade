"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.withRemoveVote = void 0;
const web3_js_1 = require("@solana/web3.js");
const sdk_1 = require("./sdk");
const accounts_1 = require("./accounts");
const api_1 = require("./api");
/**
 * Generating an instruction that removes an existing directed stake vote record account.
 *
 * Instruction requires signature of owner.
 *
 * @type {Object} args - Arguments on instruction creation
 * @param {DirectedStakeSdk} args.sdk - Directed stake SDK instance
 * @param {PublicKey} args.voteRecord - Address of the vote record to be removed; when the vote record address is not provided
 *                                      the root and owner must be provided to generate the desired vote record address
 * @param {PublicKey} args.root - Address of the directed stake root account that could be used to generate the vote record address
 * @param {PublicKey} args.rentCollector - Receiver of the rent excempt price the vote record was created with
 *                                         (when not passed as the argument the sdk wallet is the receiver of the rent)
 * @type {Object} return - Return data of generated instruction
 * @return {TransactionInstruction} return.instruction - Instruction to remove vote record
 */
async function withRemoveVote({ sdk, voteRecord, root = new web3_js_1.PublicKey(sdk_1.DEFAULT_DIRECTED_STAKE_ROOT), rentCollector, }) {
    const owner = sdk.program.provider.publicKey;
    if (!voteRecord && !root) {
        throw new Error('voteRecord or root must be provided to do removeVote');
    }
    else if (!voteRecord && root) {
        voteRecord = (0, accounts_1.voteRecordAddress)({
            directedStakeProgramId: sdk.program.programId,
            root,
            owner,
        }).address;
    }
    else if (voteRecord && !root) {
        const voteRecordData = await (0, api_1.voteRecord)({ address: voteRecord, sdk });
        root = root || voteRecordData.root;
    }
    rentCollector = (rentCollector || sdk.program.provider.publicKey);
    const instruction = await sdk.program.methods
        .removeVote()
        .accountsStrict({
        root: root,
        owner,
        voteRecord: voteRecord,
        rentCollector,
    })
        .instruction();
    return { instruction };
}
exports.withRemoveVote = withRemoveVote;
//# sourceMappingURL=withRemoveVote.js.map